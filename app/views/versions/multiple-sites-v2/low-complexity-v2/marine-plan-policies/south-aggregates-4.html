{% extends "../../layouts/low-complexity-v2.html" %}

{% from "govuk/components/radios/macro.njk" import govukRadios %}
{% from "govuk/components/textarea/macro.njk" import govukTextarea %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

{% block beforeContent %}
    {% include "../../includes/phase-banner.html" %}
    {% if data['user_type'] === 'organisation' %}
        {% include "../../includes/organisation-switcher.html" %}
    {% endif %}
    <a class="govuk-back-link govuk-link--no-visited-state" href="javascript:history.back()">Back</a>
{% endblock %}

{% set pageHeadingTextHTML %}
South Aggregates 4 (S-AGG-4)
{% endset %}

{% block pageTitle %}
{% if data['errorthispage'] == "true" %}
Error:
{% endif %}
{{ pageHeadingTextHTML }} - {{ data['headerNameExemption'] }}
{% endblock %}

{% set avoidTextarea %}
{{ govukTextarea({
    id: "marine-plan-policy-s-agg-4-avoid",
    name: "marine-plan-policy-s-agg-4-avoid",
    value: data['marine-plan-policy-s-agg-4-avoid'],
    rows: 5,
    label: {
        text: "Explain how you will avoid any impacts"
    },
    errorMessage: {
        text: "Enter how you will avoid any impacts"
    } if data['errortypetwo'] == "true" and data['marine-plan-policy-s-agg-4-how'] == "avoid"
}) }}
{% endset %}

{% set minimiseTextarea %}
{{ govukTextarea({
    id: "marine-plan-policy-s-agg-4-minimise",
    name: "marine-plan-policy-s-agg-4-minimise",
    value: data['marine-plan-policy-s-agg-4-minimise'],
    rows: 5,
    label: {
        text: "Explain how you will minimise any impacts"
    },
    errorMessage: {
        text: "Enter how you will minimise any impacts"
    } if data['errortypetwo'] == "true" and data['marine-plan-policy-s-agg-4-how'] == "minimise"
}) }}
{% endset %}

{% set mitigateTextarea %}
{{ govukTextarea({
    id: "marine-plan-policy-s-agg-4-mitigate",
    name: "marine-plan-policy-s-agg-4-mitigate",
    value: data['marine-plan-policy-s-agg-4-mitigate'],
    rows: 5,
    label: {
        text: "Explain how you will mitigate any impacts"
    },
    errorMessage: {
        text: "Enter how you will mitigate any impacts"
    } if data['errortypetwo'] == "true" and data['marine-plan-policy-s-agg-4-how'] == "mitigate"
}) }}
{% endset %}

{% block content %}

<div class="govuk-grid-row">
	<div class="govuk-grid-column-two-thirds">
		{% if data['errorthispage'] == "true" %}
		{% if data['errortypeone'] == "true" %}
		{{ govukErrorSummary({
			titleText: "There is a problem",
			errorList: [
				{ text: "Select how you will manage the impacts of your project in relation to this policy", href: "#marine-plan-policy-s-agg-4-how" }
			]
		}) }}
		{% elif data['errortypetwo'] == "true" %}
		{% if data['marine-plan-policy-s-agg-4-how'] == "avoid" %}
		{{ govukErrorSummary({
			titleText: "There is a problem",
			errorList: [
				{ text: "Enter how you will avoid any impacts", href: "#marine-plan-policy-s-agg-4-avoid" }
			]
		}) }}
		{% elif data['marine-plan-policy-s-agg-4-how'] == "minimise" %}
		{{ govukErrorSummary({
			titleText: "There is a problem",
			errorList: [
				{ text: "Enter how you will minimise any impacts", href: "#marine-plan-policy-s-agg-4-minimise" }
			]
		}) }}
		{% else %}
		{{ govukErrorSummary({
			titleText: "There is a problem",
			errorList: [
				{ text: "Enter how you will mitigate any impacts", href: "#marine-plan-policy-s-agg-4-mitigate" }
			]
		}) }}
		{% endif %}
		{% endif %}
		{% endif %}

		<form action="south-aggregates-4-router" method="post" novalidate>

			<span class="govuk-caption-l">{{ data['low-complexity-project-name-text-input'] }}</span>
			<h1 class="govuk-heading-l">{{ pageHeadingTextHTML }}</h1>

			<h2 class="govuk-heading-m">Policy information</h2>
			<p class="govuk-body">Where proposals require marine aggregates as part of their construction, preference should be given to using marine aggregates sourced from the south marine plan areas. If this is not appropriate, proposals should state why.</p>
			<p class="govuk-body"><a href="#" class="govuk-link" target="_blank" rel="noopener noreferrer">Find out more about this policy (opens in new tab)</a></p>

			<h2 class="govuk-heading-m">Example response</h2>
			{{ govukInsetText({
				html: "<p class=\"govuk-body\">Where marine aggregates are required they will be sourced from licenced offshore aggregates sites within the South Marine Plan area. The proposal is therefore considered to be in accordance with S-AGG-4.</p><p class=\"govuk-body\">The proposal will help achieve south marine plan Objective 3: To support diversification of activities which improve socio-economic conditions in coastal communities.</p><p class=\"govuk-body\"><strong>This is for guidance only - your answer should reflect your specific project.</strong></p>"
			}) }}

			<div class="govuk-form-group {% if data['errorthispage'] == 'true' and data['errortypeone'] == 'true' %}govuk-form-group--error{% endif %}">
				<fieldset class="govuk-fieldset" id="marine-plan-policy-s-agg-4-how" aria-describedby="{% if data['errortypeone'] == 'true' %}marine-plan-policy-s-agg-4-how-error{% endif %}">
					<legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
						How will you manage the impacts of your project in relation to this policy?
					</legend>
					{% if data['errortypeone'] == "true" %}
					<p id="marine-plan-policy-s-agg-4-how-error" class="govuk-error-message">
						<span class="govuk-visually-hidden">Error:</span> Select how you will manage the impacts of your project in relation to this policy
					</p>
					{% endif %}
					{{ govukRadios({
						name: "marine-plan-policy-s-agg-4-how",
						items: [
							{
								value: "avoid",
								text: "We will avoid any impacts",
								conditional: {
									html: avoidTextarea
								},
								checked: data['marine-plan-policy-s-agg-4-how'] == "avoid"
							},
							{
								value: "minimise",
								text: "We cannot fully avoid impacts, but we will minimise them",
								conditional: {
									html: minimiseTextarea
								},
								checked: data['marine-plan-policy-s-agg-4-how'] == "minimise"
							},
							{
								value: "mitigate",
								text: "We will mitigate impacts that cannot be avoided or minimised",
								conditional: {
									html: mitigateTextarea
								},
								checked: data['marine-plan-policy-s-agg-4-how'] == "mitigate"
							}
						]
					}) }}
				</fieldset>
			</div>

			<div class="govuk-button-group">
				{{ govukButton({
					text: "Save and continue"
				}) }}
			</div>

		</form>

	</div>
</div>

{% endblock %}
