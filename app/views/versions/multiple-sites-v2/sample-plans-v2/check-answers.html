{% extends "../layouts/sample-plans-v2.html" %}

{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% block beforeContent %}
    {% include "../includes/phase-banner.html" %}
    {% if data['user_type'] === 'organisation' %}
        {% include "../includes/organisation-switcher.html" %}
    {% endif %}
    {% if data['samplePlanApplicationSubmitted'] == "true" %}
        <a class="govuk-back-link" href="projects">Back</a>
    {% else %}
        <a class="govuk-back-link" href="sample-plan-start-page.html">Go back to sample plan start page</a>
    {% endif %}
{% endblock %}

<!-- Setting the big main heading at the top of the page -->
{% set pageHeadingTextHTML %}
  {% if data['samplePlanApplicationSubmitted'] == "true" %}
    {{ data['sample-plan-project-name-text-input'] }}
  {% else %}
    Check your answers before sending your information
  {% endif %}
{% endset %}

<!-- Text that show in the browser tab. Does NOT need changing -->
{% block pageTitle %}
    {{ pageHeadingTextHTML }} - {{ data['headerNameSamplePlan'] }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        {% if data['samplePlanApplicationSubmitted'] == "true" %}
            <span class="govuk-caption-l">SAM/2025/00025 â€“ Sediment sample plan</span>
        {% else %}
            <span class="govuk-caption-l">{{ data['sample-plan-project-name-text-input'] }}</span>
        {% endif %}
        <h1 class="govuk-heading-l">
            {{ pageHeadingTextHTML }}
        </h1>

        <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Project details</h2>
            </div>
            <div class="govuk-summary-card__content">
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                    {% set projectDetailsRows = [
                        {
                            key: {
                                text: "Project name"
                            },
                            value: {
                                text: data['sample-plan-project-name-text-input'] if data['sample-plan-project-name-text-input'] else "[user entered data]"
                            },
                            actions: {
                                items: [
                                    {
                                        href: "project-name?camefromcheckanswers=true",
                                        text: "Change",
                                        visuallyHiddenText: "project name",
                                        classes: "govuk-link govuk-link--no-visited-state"
                                    }
                                ]
                            }
                        },
                        {
                            key: {
                                text: "Type of activity"
                            },
                            value: {
                                text: data['sample-plan-which-activity'] if data['sample-plan-which-activity'] else "Marine dredging"
                            },
                            actions: {
                                items: [
                                    {
                                        href: "",
                                        text: "Change",
                                        visuallyHiddenText: "type of activity",
                                        classes: "govuk-link govuk-link--no-visited-state"
                                    }
                                ]
                            }
                        },
                        {
                            key: {
                                text: "Project background"
                            },
                            value: {
                                text: data['sample-plan-project-background'] if data['sample-plan-project-background'] else "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco."
                            },
                            classes: "govuk-summary-list__row--no-border",
                            actions: {
                                items: [
                                    {
                                        href: "project-background?camefromcheckanswers=true",
                                        text: "Change",
                                        visuallyHiddenText: "project background",
                                        classes: "govuk-link govuk-link--no-visited-state"
                                    }
                                ]
                            }
                        },
                        {
                            key: {
                                text: "Other contact with the Marine Management Organisation (MMO)" if data['sample-plan-other-contact'] == "No" else "Details of contact with the Marine Management Organisation"
                            },
                            value: {
                                text: "No" if data['sample-plan-other-contact'] == "No" else (data['sample-plan-other-contact-details'] if data['sample-plan-other-contact-details'] else "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco.")
                            },
                            actions: {
                                items: [
                                    {
                                        href: "",
                                        text: "Change",
                                        visuallyHiddenText: "contact with the Marine Management Organisation",
                                        classes: "govuk-link govuk-link--no-visited-state govuk-visually-hidden"
                                    }
                                ]
                            }
                        }
                    ] %}
                {% else %}
                    {% set projectDetailsRows = [
                        {
                            key: {
                                text: "Project name"
                            },
                            value: {
                                text: data['sample-plan-project-name-text-input'] if data['sample-plan-project-name-text-input'] else "[user entered data]"
                            }
                        },
                        {
                            key: {
                                text: "Type of activity"
                            },
                            value: {
                                text: data['sample-plan-which-activity'] if data['sample-plan-which-activity'] else "Marine dredging"
                            }
                        },
                        {
                            key: {
                                text: "Project background"
                            },
                            value: {
                                text: data['sample-plan-project-background'] if data['sample-plan-project-background'] else "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco."
                            },
                            classes: "govuk-summary-list__row--no-border"
                        },
                        {
                            key: {
                                text: "Other contact with the Marine Management Organisation (MMO)" if data['sample-plan-other-contact'] == "No" else "Details of contact with the Marine Management Organisation (MMO)"
                            },
                            value: {
                                text: "No" if data['sample-plan-other-contact'] == "No" else (data['sample-plan-other-contact-details'] if data['sample-plan-other-contact-details'] else "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco.")
                            }
                        }
                    ] %}
                {% endif %}

                {{ govukSummaryList({
                    rows: projectDetailsRows
                }) }}
            </div>
        </div>

        <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Licence details</h2>
            </div>
            <div class="govuk-summary-card__content">
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                    {% set licenceDetailsRows = [
                        {
                            key: {
                                text: "New or existing marine licence"
                            },
                            value: {
                                text: data['sample-plan-new-or-existing-licence'] if data['sample-plan-new-or-existing-licence'] else "New marine licence"
                            },
                            actions: {
                                items: [
                                    {
                                        href: "new-or-existing-licence?camefromcheckanswers=true",
                                        text: "Change",
                                        visuallyHiddenText: "new or existing marine licence",
                                        classes: "govuk-link govuk-link--no-visited-state"
                                    }
                                ]
                            }
                        }
                    ] %}
                {% else %}
                    {% set licenceDetailsRows = [
                        {
                            key: {
                                text: "New or existing marine licence"
                            },
                            value: {
                                text: data['sample-plan-new-or-existing-licence'] if data['sample-plan-new-or-existing-licence'] else "New marine licence"
                            }
                        }
                    ] %}
                {% endif %}

                {% if data['sample-plan-new-or-existing-licence'] == "New marine licence" %}
                    {% set licenceLengthText = "" %}
                    {% if data['sample-plan-licence-length-years'] and data['sample-plan-licence-length-months'] %}
                        {% set yearText = " year " if data['sample-plan-licence-length-years'] == "1" else " years " %}
                        {% set monthText = " month" if data['sample-plan-licence-length-months'] == "1" else " months" %}
                        {% set licenceLengthText = data['sample-plan-licence-length-years'] + yearText + data['sample-plan-licence-length-months'] + monthText %}
                    {% elif data['sample-plan-licence-length-years'] %}
                        {% set yearText = " year " if data['sample-plan-licence-length-years'] == "1" else " years " %}
                        {% set licenceLengthText = data['sample-plan-licence-length-years'] + yearText + "0 months" %}
                    {% elif data['sample-plan-licence-length-months'] %}
                        {% set monthText = " month" if data['sample-plan-licence-length-months'] == "1" else " months" %}
                        {% set licenceLengthText = "0 years " + data['sample-plan-licence-length-months'] + monthText %}
                    {% else %}
                        {% set licenceLengthText = "5 years 0 months" %}
                    {% endif %}

                    {% if data['samplePlanApplicationSubmitted'] != "true" %}
                        {% set licenceDetailsRows = licenceDetailsRows.concat([
                            {
                                key: {
                                    text: "Proposed length of the new licence"
                                },
                                value: {
                                    text: licenceLengthText
                                },
                                actions: {
                                    items: [
                                        {
                                            href: "new-licence-length?camefromcheckanswers=true",
                                            text: "Change",
                                            visuallyHiddenText: "proposed length of the new licence",
                                            classes: "govuk-link govuk-link--no-visited-state"
                                        }
                                    ]
                                }
                            }
                        ]) %}
                    {% else %}
                        {% set licenceDetailsRows = licenceDetailsRows.concat([
                            {
                                key: {
                                    text: "Proposed length of the new licence"
                                },
                                value: {
                                    text: licenceLengthText
                                }
                            }
                        ]) %}
                    {% endif %}
                {% elif data['sample-plan-new-or-existing-licence'] == "Existing marine licence" %}
                    {% set licenceExpiryText = "" %}
                    {% if data['sample-plan-licence-expiry-day'] and data['sample-plan-licence-expiry-month'] and data['sample-plan-licence-expiry-year'] %}
                        {% set monthNames = ['', 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'] %}
                        {% set monthNumber = data['sample-plan-licence-expiry-month'] | int %}
                        {% set monthName = monthNames[monthNumber] if monthNumber >= 1 and monthNumber <= 12 else data['sample-plan-licence-expiry-month'] %}
                        {% set licenceExpiryText = data['sample-plan-licence-expiry-day'] + " " + monthName + " " + data['sample-plan-licence-expiry-year'] %}
                    {% else %}
                        {% set licenceExpiryText = "10 June 2029" %}
                    {% endif %}

                    {% if data['samplePlanApplicationSubmitted'] != "true" %}
                        {% set licenceDetailsRows = licenceDetailsRows.concat([
                            {
                                key: {
                                    text: "Licence number"
                                },
                                value: {
                                    text: data['sample-plan-licence-number'] if data['sample-plan-licence-number'] else "MLA/2025/00123"
                                },
                                classes: "govuk-summary-list__row--no-border",
                                actions: {
                                    items: [
                                        {
                                            href: "existing-licence-expiry?camefromcheckanswers=true",
                                            text: "Change",
                                            visuallyHiddenText: "licence number",
                                            classes: "govuk-link govuk-link--no-visited-state"
                                        }
                                    ]
                                }
                            },
                            {
                                key: {
                                    text: "Licence expiry date"
                                },
                                value: {
                                    text: licenceExpiryText
                                },
                                actions: {
                                    items: [
                                        {
                                            href: "",
                                            text: "Change",
                                            visuallyHiddenText: "licence expiry date",
                                            classes: "govuk-link govuk-link--no-visited-state govuk-visually-hidden"
                                        }
                                    ]
                                }
                            }
                        ]) %}
                    {% else %}
                        {% set licenceDetailsRows = licenceDetailsRows.concat([
                            {
                                key: {
                                    text: "Licence number"
                                },
                                value: {
                                    text: data['sample-plan-licence-number'] if data['sample-plan-licence-number'] else "MLA/2025/00123"
                                },
                                classes: "govuk-summary-list__row--no-border"
                            },
                            {
                                key: {
                                    text: "Licence expiry date"
                                },
                                value: {
                                    text: licenceExpiryText
                                }
                            }
                        ]) %}
                    {% endif %}
                {% endif %}

                {{ govukSummaryList({
                    rows: licenceDetailsRows
                }) }}
            </div>
        </div>

        <!-- Only show dredge site sections if the activity includes dredging -->
        {% if data['sample-plan-which-activity'] == "Marine dredging" or data['sample-plan-which-activity'] == "Marine dredging and disposal" %}
        <!-- Dredge site location section -->
        <div id="providing-dredge-site-location" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Providing the dredge site location</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="dredging-site-locations/review-dredging-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> dredge site location</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Method of providing site location
                        </dt>
                        <dd class="govuk-summary-list__value">
                            File uploaded
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            File type
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-plan-file-type'] == 'kml' %}
                                KML
                            {% elif data['sample-plan-file-type'] == 'shapefile' %}
                                Shapefile
                            {% else %}
                                Shapefile
                            {% endif %}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            File uploaded
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-plan-file-type'] == 'kml' %}
                                dredge-site-coordinates.kml
                            {% else %}
                                dredge-site-coordinates.zip
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>

        <!-- Dredge site 1 details section -->
        <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Dredge site 1 details</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="dredging-site-locations/review-dredging-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> dredge site 1 details</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site name
                        </dt>
                        <dd class="govuk-summary-list__value">
                            Dredge site south
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key map-label">
                            Map view
                        </dt>
                        <dd class="govuk-summary-list__value">
                            <img src="/public/images/map-5-points.jpg" alt="Map showing site 1 location" />
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Type of material being dredged
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['dredging-details-site-1-completed'] %}
                                {% set materialTypes = [] %}
                                {% if data['dredging-details-site-1-material-type'] %}
                                    {% for type in data['dredging-details-site-1-material-type'] %}
                                        {% if type == 'capital-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Capital dredged material'), materialTypes) %}
                                        {% elif type == 'maintenance-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Maintenance dredged material'), materialTypes) %}
                                        {% elif type == 'non-dredged-sediments' %}
                                            {% set materialTypes = (materialTypes.push('Non-dredged sediments'), materialTypes) %}
                                        {% elif type == 'organic-material' %}
                                            {% set materialTypes = (materialTypes.push('Organic material of natural origin'), materialTypes) %}
                                        {% elif type == 'remediation-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Remediation (environmental) dredged material'), materialTypes) %}
                                        {% elif type == 'other' and data['dredging-details-site-1-material-type-other'] %}
                                            {% set materialTypes = (materialTypes.push('Other: ' + data['dredging-details-site-1-material-type-other']), materialTypes) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ materialTypes | join('<br>') | safe if materialTypes.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Proposed method of dredging
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['dredging-details-site-1-completed'] %}
                                {% set methods = [] %}
                                {% if data['dredging-details-site-1-method'] %}
                                    {% for method in data['dredging-details-site-1-method'] %}
                                        {% if method == 'backhoe' %}
                                            {% set methods = (methods.push('Backhoe'), methods) %}
                                        {% elif method == 'cutter-suction' %}
                                            {% set methods = (methods.push('Cutter suction'), methods) %}
                                        {% elif method == 'grab' %}
                                            {% set methods = (methods.push('Grab'), methods) %}
                                        {% elif method == 'plough-bed-levelling' %}
                                            {% set methods = (methods.push('Plough or bed levelling'), methods) %}
                                        {% elif method == 'trailer-suction' %}
                                            {% set methods = (methods.push('Trailer suction'), methods) %}
                                        {% elif method == 'water-injection-agitation' %}
                                            {% set methods = (methods.push('Water injection or agitation dredging'), methods) %}
                                        {% elif method == 'other' and data['dredging-details-site-1-method-other'] %}
                                            {% set methods = (methods.push('Other: ' + data['dredging-details-site-1-method-other']), methods) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ methods | join('<br>') | safe if methods.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>



                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Maximum dredge volume
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['maximum-dredge-volume-completed'] %}
                                {% if data['maximum-dredge-volume-total'] %}
                                    {{ data['maximum-dredge-volume-total'] | addCommas }} {{ 'cubic metre' if data['maximum-dredge-volume-total'] == '1' else 'cubic metres' }}, total volume over the full licence period
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Dredge frequency
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['maximum-dredge-volume-completed'] %}
                                {% if data['maximum-dredge-volume-frequency'] %}
                                    {{ data['maximum-dredge-volume-frequency'] }}
                                {% else %}
                                    Not provided
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Dredge depth
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['dredging-details-site-1-depth-completed'] and data['dredging-details-site-1-depth'] %}
                                {{ data['dredging-details-site-1-depth'] }} {{ 'metre' if data['dredging-details-site-1-depth'] == '1' else 'metres' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
        {% endif %}

        <!-- Only show disposal site sections if the activity includes disposal -->
        {% if data['sample-plan-which-activity'] == "Marine disposal" or data['sample-plan-which-activity'] == "Marine dredging and disposal" %}
        <!-- Providing the disposal site location section -->
        <!--<div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Providing the disposal site location</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="">
                        Change<span class="govuk-visually-hidden"> disposal site location</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Method of providing site location
                        </dt>
                        <dd class="govuk-summary-list__value">
                            Existing disposal site selected
                        </dd>
                    </div>
                </dl>
            </div>
        </div>-->

        <!-- Existing disposal site 1 details section -->
        <div id="disposal-site-1-details" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Existing disposal site 1 details</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/review-disposal-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> existing disposal site 1</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site code
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-code'] or 'No site code available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site name
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-name'] or 'No site name available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Country
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-country'] or 'No country available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Sea area
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-sea-area'] or 'No sea area available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Status
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['selected-disposal-site-status'] %}
                                {% if data['selected-disposal-site-status'] == 'Open' %}
                                    <strong class="govuk-tag govuk-tag--green">{{ data['selected-disposal-site-status'] }}</strong>
                                {% elif data['selected-disposal-site-status'] == 'Closed' %}
                                    <strong class="govuk-tag govuk-tag--red">{{ data['selected-disposal-site-status'] }}</strong>
                                {% elif data['selected-disposal-site-status'] == 'Disused' %}
                                    <strong class="govuk-tag govuk-tag--grey">{{ data['selected-disposal-site-status'] }}</strong>
                                {% else %}
                                    <strong class="govuk-tag">{{ data['selected-disposal-site-status'] }}</strong>
                                {% endif %}
                            {% else %}
                                No status available
                            {% endif %}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key map-label">
                            Map view
                        </dt>
                        <dd class="govuk-summary-list__value">
                            <img src="/public/images/map-4-points.jpg" alt="Map showing disposal site location" />
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Type of material being disposed
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-material-type-completed'] %}
                                {% set materialTypes = [] %}
                                {% if data['sample-disposal-details-site-1-material-type'] %}
                                    {% for type in data['sample-disposal-details-site-1-material-type'] %}
                                        {% if type == 'capital-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Capital dredged material'), materialTypes) %}
                                        {% elif type == 'maintenance-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Maintenance dredged material'), materialTypes) %}
                                        {% elif type == 'non-dredged-sediments' %}
                                            {% set materialTypes = (materialTypes.push('Non-dredged sediments'), materialTypes) %}
                                        {% elif type == 'organic-material' %}
                                            {% set materialTypes = (materialTypes.push('Organic material of natural origin (for example, seaweed)'), materialTypes) %}
                                        {% elif type == 'other' and data['sample-disposal-details-site-1-material-type-other'] %}
                                            {% set materialTypes = (materialTypes.push('Other: ' + data['sample-disposal-details-site-1-material-type-other']), materialTypes) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ materialTypes | join('<br>') | safe if materialTypes.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Proposed method of disposal
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% set methods = [] %}
                            {% if data['sample-disposal-details-site-1-method'] %}
                                {% for method in data['sample-disposal-details-site-1-method'] %}
                                    {% if method == 'backhoe-dredger' %}
                                        {% set methods = (methods.push('Backhoe dredger'), methods) %}
                                    {% elif method == 'bottom-dumping-hopper' %}
                                        {% set methods = (methods.push('Bottom dumping (hopper)'), methods) %}
                                    {% elif method == 'direct-pumping-trailing-suction' %}
                                        {% set methods = (methods.push('Direct pumping from trailing suction hopper dredger'), methods) %}
                                    {% elif method == 'pump-out-floating-pipeline' %}
                                        {% set methods = (methods.push('Pump-out via floating pipeline'), methods) %}
                                    {% elif method == 'rainbowing' %}
                                        {% set methods = (methods.push('Rainbowing'), methods) %}
                                    {% elif method == 'split-hopper-barge' %}
                                        {% set methods = (methods.push('Split hopper barge'), methods) %}
                                    {% elif method == 'other' and data['sample-disposal-details-site-1-method-other'] %}
                                        {% set methods = (methods.push('Other: ' + data['sample-disposal-details-site-1-method-other']), methods) %}
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            {{ methods | join('<br>') | safe if methods.length > 0 else 'Not provided' }}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Maximum disposal volume
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-1-maximum-volume-completed'] %}
                                {% if data['sample-disposal-site-1-total-volume'] %}
                                    {{ data['sample-disposal-site-1-total-volume'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-1-total-volume'] == '1' else 'cubic metres' }}, total volume over the full licence period
                                {% endif %}
                                {% if data['sample-disposal-site-1-annual-volume'] %}
                                    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
                                    {{ data['sample-disposal-site-1-annual-volume'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-1-annual-volume'] == '1' else 'cubic metres' }}, annual volume
                                {% endif %}
                                {% if data['sample-disposal-site-1-volume-per-campaign'] and data['sample-disposal-site-1-campaigns-per-year'] %}
                                    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
                                    {{ data['sample-disposal-site-1-volume-per-campaign'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-1-volume-per-campaign'] == '1' else 'cubic metres' }}, volume per campaign<br>
                                    {{ data['sample-disposal-site-1-campaigns-per-year'] }} {{ 'campaign' if data['sample-disposal-site-1-campaigns-per-year'] == '1' else 'campaigns' }} per year
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Beneficial use
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-1-beneficial-use-completed'] %}
                                {% if data['sample-disposal-site-1-beneficial-use'] == 'yes' %}
                                    Yes: {{ data['sample-disposal-site-1-beneficial-use-description'] }}
                                {% else %}
                                    No
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>

        <!-- Existing disposal site 2 details section (conditional) -->
        {% if data['sample-disposal-site-2-selected'] %}
        <div id="disposal-site-2-details" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Existing disposal site 2 details</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/review-disposal-site-details?camefromcheckanswers=true&site=2">
                        Change<span class="govuk-visually-hidden"> existing disposal site 2</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site code
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-2-code'] or 'No site code available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site name
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-2-name'] or 'No site name available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site location
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-2-country'] or 'No country available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Marine area
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['selected-disposal-site-2-sea-area'] or 'No sea area available' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Status
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['selected-disposal-site-2-status'] %}
                                {% if data['selected-disposal-site-2-status'] == 'Open' %}
                                    <strong class="govuk-tag govuk-tag--green">{{ data['selected-disposal-site-2-status'] }}</strong>
                                {% elif data['selected-disposal-site-2-status'] == 'Closed' %}
                                    <strong class="govuk-tag govuk-tag--red">{{ data['selected-disposal-site-2-status'] }}</strong>
                                {% elif data['selected-disposal-site-2-status'] == 'Disused' %}
                                    <strong class="govuk-tag govuk-tag--grey">{{ data['selected-disposal-site-2-status'] }}</strong>
                                {% else %}
                                    <strong class="govuk-tag">{{ data['selected-disposal-site-2-status'] }}</strong>
                                {% endif %}
                            {% else %}
                                No status available
                            {% endif %}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key map-label">
                            Map view
                        </dt>
                        <dd class="govuk-summary-list__value">
                            <img src="/public/images/map-5-points.jpg" alt="Map showing disposal site location" />
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Type of material being disposed
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-2-material-type-completed'] %}
                                {% set materialTypes = [] %}
                                {% if data['sample-disposal-details-site-2-material-type'] %}
                                    {% for type in data['sample-disposal-details-site-2-material-type'] %}
                                        {% if type == 'capital-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Capital dredged material'), materialTypes) %}
                                        {% elif type == 'maintenance-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Maintenance dredged material'), materialTypes) %}
                                        {% elif type == 'non-dredged-sediments' %}
                                            {% set materialTypes = (materialTypes.push('Non-dredged sediments'), materialTypes) %}
                                        {% elif type == 'organic-material' %}
                                            {% set materialTypes = (materialTypes.push('Organic material of natural origin (for example, seaweed)'), materialTypes) %}
                                        {% elif type == 'other' and data['sample-disposal-details-site-2-material-type-other'] %}
                                            {% set materialTypes = (materialTypes.push('Other: ' + data['sample-disposal-details-site-2-material-type-other']), materialTypes) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ materialTypes | join('<br>') | safe if materialTypes.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Proposed method of disposal
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% set methods = [] %}
                            {% if data['sample-disposal-details-site-2-method'] %}
                                {% for method in data['sample-disposal-details-site-2-method'] %}
                                    {% if method == 'backhoe-dredger' %}
                                        {% set methods = (methods.push('Backhoe dredger'), methods) %}
                                    {% elif method == 'bottom-dumping-hopper' %}
                                        {% set methods = (methods.push('Bottom dumping (hopper)'), methods) %}
                                    {% elif method == 'direct-pumping-trailing-suction' %}
                                        {% set methods = (methods.push('Direct pumping from trailing suction hopper dredger'), methods) %}
                                    {% elif method == 'pump-out-floating-pipeline' %}
                                        {% set methods = (methods.push('Pump-out via floating pipeline'), methods) %}
                                    {% elif method == 'rainbowing' %}
                                        {% set methods = (methods.push('Rainbowing'), methods) %}
                                    {% elif method == 'split-hopper-barge' %}
                                        {% set methods = (methods.push('Split hopper barge'), methods) %}
                                    {% elif method == 'other' and data['sample-disposal-details-site-2-method-other'] %}
                                        {% set methods = (methods.push('Other: ' + data['sample-disposal-details-site-2-method-other']), methods) %}
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                            {{ methods | join('<br>') | safe if methods.length > 0 else 'Not provided' }}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Maximum disposal volume
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-2-maximum-volume-completed'] %}
                                {% if data['sample-disposal-site-2-total-volume'] %}
                                    {{ data['sample-disposal-site-2-total-volume'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-2-total-volume'] == '1' else 'cubic metres' }}, total volume over the full licence period
                                {% endif %}
                                {% if data['sample-disposal-site-2-annual-volume'] %}
                                    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
                                    {{ data['sample-disposal-site-2-annual-volume'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-2-annual-volume'] == '1' else 'cubic metres' }}, annual volume
                                {% endif %}
                                {% if data['sample-disposal-site-2-volume-per-campaign'] and data['sample-disposal-site-2-campaigns-per-year'] %}
                                    <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
                                    {{ data['sample-disposal-site-2-volume-per-campaign'] | addCommas }} {{ 'cubic metre' if data['sample-disposal-site-2-volume-per-campaign'] == '1' else 'cubic metres' }}, volume per campaign<br>
                                    {{ data['sample-disposal-site-2-campaigns-per-year'] }} {{ 'campaign' if data['sample-disposal-site-2-campaigns-per-year'] == '1' else 'campaigns' }} per year
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Beneficial use
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['sample-disposal-site-2-beneficial-use-completed'] %}
                                {% if data['sample-disposal-site-2-beneficial-use'] == 'yes' %}
                                    Yes: {{ data['sample-disposal-site-2-beneficial-use-description'] }}
                                {% else %}
                                    No
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
        {% endif %}
        {% endif %}

        <!-- New file upload disposal site section -->
        {% if data['has-visited-new-disposal-site-locations'] and (data['disposal-site-journey-type'] == 'new' or data['disposal-site-journey-type'] == 'both') %}
        <!-- Providing the new disposal site location section -->
        <div id="site-location" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">
                    Providing the new disposal site location
                </h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/new-disposal-sites/review-new-disposal-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> how you provide the new disposal site location</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Method of providing site location
                        </dt>
                        <dd class="govuk-summary-list__value">
                            File uploaded
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            File type
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-file-type'] == 'kml' %}
                                KML
                            {% elif data['new-disposal-file-type'] == 'shapefile' %}
                                Shapefile
                            {% else %}
                                Shapefile
                            {% endif %}
                        </dd>
                    </div>
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            File uploaded
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-file-type'] == 'kml' %}
                                new-disposal-site-coordinates.kml
                            {% else %}
                                new-disposal-site-coordinates.zip
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>

        <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">New disposal site 1 details</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/new-disposal-sites/review-new-disposal-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> new disposal site 1 details</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site name
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['new-disposal-site-1-name'] or 'South channel disposal site' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key map-label">
                            Map view
                        </dt>
                        <dd class="govuk-summary-list__value">
                            <img src="/public/images/map-4-points.jpg" alt="Map showing new disposal site 1 location" />
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Type of material being disposed
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-details-site-1-completed'] %}
                                {% set materialTypes = [] %}
                                {% if data['new-disposal-details-site-1-material-type'] %}
                                    {% for type in data['new-disposal-details-site-1-material-type'] %}
                                        {% if type == 'capital-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Capital dredged material'), materialTypes) %}
                                        {% elif type == 'maintenance-dredged-material' %}
                                            {% set materialTypes = (materialTypes.push('Maintenance dredged material'), materialTypes) %}
                                        {% elif type == 'non-dredged-sediments' %}
                                            {% set materialTypes = (materialTypes.push('Non-dredged sediments'), materialTypes) %}
                                        {% elif type == 'organic-material' %}
                                            {% set materialTypes = (materialTypes.push('Organic material of natural origin (for example, seaweed)'), materialTypes) %}
                                        {% elif type == 'other' and data['new-disposal-details-site-1-material-type-other'] %}
                                            {% set materialTypes = (materialTypes.push('Other: ' + data['new-disposal-details-site-1-material-type-other']), materialTypes) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ materialTypes | join('<br>') | safe if materialTypes.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Proposed method of disposal
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-details-site-1-completed'] %}
                                {% set methods = [] %}
                                {% if data['new-disposal-details-site-1-method'] %}
                                    {% for method in data['new-disposal-details-site-1-method'] %}
                                        {% if method == 'backhoe-dredger' %}
                                            {% set methods = (methods.push('Backhoe dredger'), methods) %}
                                        {% elif method == 'bottom-dumping-hopper' %}
                                            {% set methods = (methods.push('Bottom dumping (hopper)'), methods) %}
                                        {% elif method == 'direct-pumping-trailing-suction' %}
                                            {% set methods = (methods.push('Direct pumping from trailing suction hopper dredger'), methods) %}
                                        {% elif method == 'pump-out-floating-pipeline' %}
                                            {% set methods = (methods.push('Pump-out via floating pipeline'), methods) %}
                                        {% elif method == 'rainbowing' %}
                                            {% set methods = (methods.push('Rainbowing'), methods) %}
                                        {% elif method == 'split-hopper-barge' %}
                                            {% set methods = (methods.push('Split hopper barge'), methods) %}
                                        {% elif method == 'other' and data['new-disposal-details-site-1-method-other'] %}
                                            {% set methods = (methods.push('Other: ' + data['new-disposal-details-site-1-method-other']), methods) %}
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                                {{ methods | join('<br>') | safe if methods.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Maximum proposed disposal volume
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-maximum-volume-completed'] %}
                                {% if data['new-disposal-site-1-total-volume'] %}
                                    {{ data['new-disposal-site-1-total-volume'] | addCommas }} cubic metres, total volume over the full licence period
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Beneficial use
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-beneficial-use-completed'] %}
                                {% if data['new-disposal-site-1-beneficial-use'] == 'yes' %}
                                    Yes: {{ data['new-disposal-site-1-beneficial-use-description'] }}
                                {% else %}
                                    No
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
        {% endif %}

        <!-- Manual entry disposal sites section -->
        {% if data['has-visited-manual-disposal-site-locations'] and (data['disposal-site-journey-type'] == 'manual-entry' or data['disposal-site-journey-type'] == 'both') %}
        <!-- Providing the new disposal site location section -->
        <div id="site-location" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">
                    Providing the new disposal site location{% if siteCount > 1 %}s{% endif %}
                </h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/new-disposal-sites/manual-entry/review-manual-disposal-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> how you provide the new disposal site location</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Method of providing site location
                        </dt>
                        <dd class="govuk-summary-list__value">
                            Enter the coordinates of the site manually
                        </dd>
                    </div>
                </dl>
            </div>
        </div>

        {% set siteCount = data['disposal-site-manual-entry-count'] | int %}
        {% if not siteCount or siteCount == 0 %}
            {% set siteCount = 1 %}
        {% endif %}
        
        {% for siteNum in range(1, siteCount + 1) %}
        <div class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">New disposal site {{ siteNum }} details</h2>
                {% if data['samplePlanApplicationSubmitted'] != "true" %}
                <div class="govuk-summary-card__actions">
                    <a class="govuk-link govuk-link--no-visited-state" href="disposal-site-locations/new-disposal-sites/manual-entry/review-manual-disposal-site-details?camefromcheckanswers=true">
                        Change<span class="govuk-visually-hidden"> new disposal site {{ siteNum }} details</span>
                    </a>
                </div>
                {% endif %}
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Site name
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {{ data['new-disposal-site-' + siteNum + '-name'] or 'Not provided' }}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Single or multiple sets of coordinates
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% set entryMethod = data['new-disposal-site-' + siteNum + '-coordinate-entry-method'] %}
                            {% if entryMethod == 'Enter one set of coordinates and a width to create a circular site' %}
                                Manually enter one set of coordinates and a width to create a circular site
                            {% elif entryMethod == 'Enter multiple sets of coordinates to mark the boundary of the site' %}
                                Manually enter multiple sets of coordinates to mark the boundary of the site
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Coordinate system
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% set coordinateSystem = data['new-disposal-site-' + siteNum + '-coordinate-system'] %}
                            {% if coordinateSystem == 'WGS84 (World Geodetic System 1984)' %}
                                WGS84 (World Geodetic System 1984)<br>Latitude and longitude
                            {% elif coordinateSystem == 'British National Grid (OSGB36)' %}
                                British National Grid (OSGB36)<br>Eastings and Northings
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                    
                    {% if entryMethod == 'Enter one set of coordinates and a width to create a circular site' %}
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">
                                Coordinates at centre site
                            </dt>
                            <dd class="govuk-summary-list__value">
                                {% set centreLat = data['new-disposal-site-' + siteNum + '-centre-latitude'] %}
                                {% set centreLong = data['new-disposal-site-' + siteNum + '-centre-longitude'] %}
                                {% if centreLat and centreLong %}
                                    {{ centreLat }}, {{ centreLong }}
                                {% else %}
                                    Not provided
                                {% endif %}
                            </dd>
                        </div>
                        
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">
                                Width of circular site
                            </dt>
                            <dd class="govuk-summary-list__value">
                                {% set width = data['new-disposal-site-' + siteNum + '-width'] %}
                                {% if width %}
                                    {{ width }} metres
                                {% else %}
                                    Not provided
                                {% endif %}
                            </dd>
                        </div>
                    {% elif entryMethod == 'Enter multiple sets of coordinates to mark the boundary of the site' %}
                        {% set lastPointNum = 0 %}
                        {% for i in range(1, 6) %}
                            {% if data['new-disposal-site-' + siteNum + '-point-' + i + '-latitude'] and data['new-disposal-site-' + siteNum + '-point-' + i + '-longitude'] %}
                                {% set lastPointNum = i %}
                            {% endif %}
                        {% endfor %}
                        
                        {% for pointNum in range(1, 6) %}
                            {% set pointLat = data['new-disposal-site-' + siteNum + '-point-' + pointNum + '-latitude'] %}
                            {% set pointLong = data['new-disposal-site-' + siteNum + '-point-' + pointNum + '-longitude'] %}
                            
                            {% if pointLat and pointLong %}
                                <div class="govuk-summary-list__row {% if pointNum < lastPointNum %}govuk-summary-list__row--no-border{% endif %}">
                                    <dt class="govuk-summary-list__key">
                                        {% if pointNum == 1 %}
                                        Start and end points
                                        {% else %}
                                        Point {{ pointNum }}
                                        {% endif %}
                                    </dt>
                                    <dd class="govuk-summary-list__value">
                                        {{ pointLat }}, {{ pointLong }}
                                    </dd>
                                </div>
                            {% elif pointNum <= 3 %}
                                <div class="govuk-summary-list__row {% if pointNum < 3 %}govuk-summary-list__row--no-border{% endif %}">
                                    <dt class="govuk-summary-list__key">
                                        {% if pointNum == 1 %}
                                        Start and end points
                                        {% else %}
                                        Point {{ pointNum }}
                                        {% endif %}
                                    </dt>
                                    <dd class="govuk-summary-list__value">
                                        Not provided
                                    </dd>
                                </div>
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key map-label">
                            Map view
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if entryMethod == 'Enter one set of coordinates and a width to create a circular site' %}
                                <img src="/public/images/map-circle.jpg" alt="Map showing new disposal site {{ siteNum }} as circular area" />
                            {% else %}
                                {% set pointCount = 0 %}
                                {% for i in range(1, 6) %}
                                    {% if data['new-disposal-site-' + siteNum + '-point-' + i + '-latitude'] %}
                                        {% set pointCount = pointCount + 1 %}
                                    {% endif %}
                                {% endfor %}
                                {% if pointCount == 3 %}
                                    <img src="/public/images/map-3-points.jpg" alt="Map showing new disposal site {{ siteNum }} with 3 coordinate points" />
                                {% elif pointCount == 4 %}
                                    <img src="/public/images/map-4-points.jpg" alt="Map showing new disposal site {{ siteNum }} with 4 coordinate points" />
                                {% elif pointCount == 5 %}
                                    <img src="/public/images/map-5-points.jpg" alt="Map showing new disposal site {{ siteNum }} with 5 coordinate points" />
                                {% else %}
                                    <img src="/public/images/map-drawn.jpg" alt="Map showing new disposal site {{ siteNum }}" />
                                {% endif %}
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row govuk-summary-list__row--no-border">
                        <dt class="govuk-summary-list__key">
                            Type of material being disposed
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-details-site-' + siteNum + '-material-type'] %}
                                {% set materialTypes = [] %}
                                {% for type in data['new-disposal-details-site-' + siteNum + '-material-type'] %}
                                    {% if type == 'capital-dredged-material' %}
                                        {% set materialTypes = (materialTypes.push('Capital dredged material'), materialTypes) %}
                                    {% elif type == 'maintenance-dredged-material' %}
                                        {% set materialTypes = (materialTypes.push('Maintenance dredged material'), materialTypes) %}
                                    {% elif type == 'non-dredged-sediments' %}
                                        {% set materialTypes = (materialTypes.push('Non-dredged sediments'), materialTypes) %}
                                    {% elif type == 'organic-material' %}
                                        {% set materialTypes = (materialTypes.push('Organic material of natural origin (for example, seaweed)'), materialTypes) %}
                                    {% elif type == 'other' and data['new-disposal-details-site-' + siteNum + '-material-type-other'] %}
                                        {% set materialTypes = (materialTypes.push('Other: ' + data['new-disposal-details-site-' + siteNum + '-material-type-other']), materialTypes) %}
                                    {% endif %}
                                {% endfor %}
                                {{ materialTypes | join('<br>') | safe if materialTypes.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Proposed method of disposal
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-details-site-' + siteNum + '-method'] %}
                                {% set methods = [] %}
                                {% for method in data['new-disposal-details-site-' + siteNum + '-method'] %}
                                    {% if method == 'backhoe-dredger' %}
                                        {% set methods = (methods.push('Backhoe dredger'), methods) %}
                                    {% elif method == 'bottom-dumping-hopper' %}
                                        {% set methods = (methods.push('Bottom dumping (hopper)'), methods) %}
                                    {% elif method == 'direct-pumping-trailing-suction' %}
                                        {% set methods = (methods.push('Direct pumping from trailing suction hopper dredger'), methods) %}
                                    {% elif method == 'pump-out-floating-pipeline' %}
                                        {% set methods = (methods.push('Pump-out via floating pipeline'), methods) %}
                                    {% elif method == 'rainbowing' %}
                                        {% set methods = (methods.push('Rainbowing'), methods) %}
                                    {% elif method == 'split-hopper-barge' %}
                                        {% set methods = (methods.push('Split hopper barge'), methods) %}
                                    {% elif method == 'side-casting' %}
                                        {% set methods = (methods.push('Side casting'), methods) %}
                                    {% elif method == 'other' and data['new-disposal-details-site-' + siteNum + '-method-other'] %}
                                        {% set methods = (methods.push('Other: ' + data['new-disposal-details-site-' + siteNum + '-method-other']), methods) %}
                                    {% endif %}
                                {% endfor %}
                                {{ methods | join('<br>') | safe if methods.length > 0 else 'Not provided' }}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Maximum proposed disposal volume
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-site-' + siteNum + '-total-volume'] %}
                                {{ data['new-disposal-site-' + siteNum + '-total-volume'] | addCommas }} cubic metres, total volume over the full licence period
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>

                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Beneficial use
                        </dt>
                        <dd class="govuk-summary-list__value">
                            {% if data['new-disposal-site-' + siteNum + '-beneficial-use'] %}
                                {% if data['new-disposal-site-' + siteNum + '-beneficial-use'] == 'yes' %}
                                    Yes: {{ data['new-disposal-site-' + siteNum + '-beneficial-use-description'] }}
                                {% else %}
                                    No
                                {% endif %}
                            {% else %}
                                Not provided
                            {% endif %}
                        </dd>
                    </div>
                </dl>
            </div>
        </div>
        {% endfor %}
        {% endif %}

        <!-- Fee estimate section -->
        <div id="fee-estimate" class="govuk-summary-card">
            <div class="govuk-summary-card__title-wrapper">
                <h2 class="govuk-summary-card__title">Fee estimate</h2>
            </div>
            <div class="govuk-summary-card__content">
                <dl class="govuk-summary-list">
                    <div class="govuk-summary-list__row">
                        <dt class="govuk-summary-list__key">
                            Fee estimate accepted
                        </dt>
                        <dd class="govuk-summary-list__value">
                            Â£3,102.24
                        </dd>
                        {% if data['samplePlanApplicationSubmitted'] != "true" %}
                        <dd class="govuk-summary-list__actions">
                            <a class="govuk-link govuk-link--no-visited-state" href="fee-estimate?camefromcheckanswers=true">
                                Change<span class="govuk-visually-hidden"> fee estimate accepted</span>
                            </a>
                        </dd>
                        {% endif %}
                    </div>
                </dl>
            </div>
        </div>

        {% if data['samplePlanApplicationSubmitted'] != "true" %}
        <form action="check-answers-router" method="post" novalidate>
            <div class="govuk-button-group">
                {{ govukButton({
                    text: "Continue"
                }) }}
            </div>
        </form>
        {% endif %}

    </div>
</div>
{% endblock %}
